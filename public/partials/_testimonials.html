<!-- Testimonials Section -->
<section class="section testimonials" id="testimonials">
    <div class="container">
        <h2 class="section-title">آراء عملائنا</h2>
        <p class="section-subtitle">شاهدي تجارب عملائنا الحقيقية مع فستان لوتس</p>
        
        <div class="testimonials-slider">
            <div class="testimonial-card fade-in-up">
                <div class="testimonial-badge-container">
                    <div class="testimonial-badge">عميل موثق</div>
                </div>
                <div class="testimonial-image-wrapper">
                    <div class="testimonial-image-container">
                        <img src="images/reviews/PHOTO-2025-04-20-14-59-10.jpg" alt="تقييم عميل" loading="lazy">
                    </div>
                </div>
                <div class="testimonial-content">
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"بجد الفستان ده حاجة تحفة! خامته روعة وشكله أنيق جداً، أنا طلبت تلات ألوان والشحن وصل بسرعة. لما لبسته كل الناس سألتني جبتيه منين. أنا بقالي فترة بدور على حاجة كده وأخيراً لقيتها!"</p>
                    <div class="testimonial-author">سارة محمد</div>
                    <div class="testimonial-city">القاهرة</div>
                </div>
            </div>

            <div class="testimonial-card fade-in-up delay-1">
                <div class="testimonial-badge-container">
                    <div class="testimonial-badge">عميل موثق</div>
                </div>
                <div class="testimonial-image-wrapper">
                    <div class="testimonial-image-container">
                        <img src="images/reviews/black-review.jpeg" alt="تقييم عميل" loading="lazy">
                    </div>
                </div>
                <div class="testimonial-content">
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"والله أنا مش بعرف أكتب ريفيوهات كتير، بس الفستان ده لازم أقول رأيي فيه. المقاس مظبوط بالظبط والخامة تحفة ومش بتتكرمش! اللون الأسود اللي أخدته شيك جداً، ممكن ألبسه في الشغل والمناسبات كمان. مش هكدب عليكم، أنا لسه طالبة اللون البيج!"</p>
                    <div class="testimonial-author">منة علي</div>
                    <div class="testimonial-city">الإسكندرية</div>
                </div>
            </div>

            <div class="testimonial-card fade-in-up delay-2">
                <div class="testimonial-badge-container">
                    <div class="testimonial-badge">عميل مميز</div>
                </div>
                <div class="testimonial-image-wrapper">
                    <div class="testimonial-image-container">
                        <img src="images/reviews/review-3.png" alt="تقييم عميل" loading="lazy">
                    </div>
                </div>
                <div class="testimonial-content">
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"أنا طلبت من فستان لوتس عشان كنت محتاجة حاجة للشغل تبقى شيك ومحترمة، وطلعت أحسن بكتير من اللي متوقعاه! الخامة فاخرة قوي ويستاهل سعره وزيادة. العرض بتاع التلات قطع توفير جامد، أنا خدت أبيض وأسود وبيج. الدنيا برد دلوقتي والفستان دافي وشيك!"</p>
                    <div class="testimonial-author">هدى عبد الرحمن</div>
                    <div class="testimonial-city">المنصورة</div>
                </div>
            </div>
        </div>
        
        <div class="testimonials-slider" style="margin-top: 30px;">
            <div class="testimonial-card fade-in-up">
                <div class="testimonial-image-wrapper">
                    <div class="testimonial-image-container">
                        <img src="images/reviews/navy-blue-review.jpeg" alt="تقييم عميل" loading="lazy">
                    </div>
                </div>
                <div class="testimonial-content">
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                    <p class="testimonial-text">"جربت أطلب أونلاين كذا مرة وكانت تجربة وحشة، بس مع فستان لوتس المرة دي مختلفة خالص! الفستان زي الصورة بالظبط، والدفع عند الاستلام ريحني جداً. المقاسات مظبوطة وعجبني إن في جدول مقاسات واضح. ياريت بس يضيفوا ألوان أكتر!"</p>
                    <div class="testimonial-author">رضوى محمود</div>
                    <div class="testimonial-city">طنطا</div>
                </div>
            </div>
            
            <div class="testimonial-card fade-in-up delay-1">
                <div class="testimonial-image-wrapper">
                    <div class="testimonial-image-container">
                        <img src="images/reviews/PHOTO-2025-04-20-14-59-09.jpg" alt="تقييم عميل" loading="lazy">
                    </div>
                </div>
                <div class="testimonial-content">
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"أنا كنت خايفة أوي من الأوردر أونلاين، بس صاحبتي ورتني الفستان وعجبني جداً فقررت أطلب. بجد مش هندم! خدمة العملاء محترمة جداً والرد سريع على الواتس، والأهم إن الشحن سريع والفستان وصل في يومين بس. هو مريح أوي وشكله شيك على الجسم!"</p>
                    <div class="testimonial-author">جيهان السيد</div>
                    <div class="testimonial-city">القاهرة</div>
                </div>
            </div>

            <div class="testimonial-card fade-in-up delay-2">
                <div class="testimonial-image-wrapper">
                    <div class="testimonial-image-container">
                        <img src="images/reviews/PHOTO-2025-04-20-14-59-11.jpg" alt="تقييم عميل" loading="lazy">
                    </div>
                </div>
                <div class="testimonial-content">
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"فستان لوتس مناسب جدا للشغل والمناسبات! جودة القماش عالية والخياطة متقنة. أنا اشتريت الفستان الأسود والبيج وكنت عايزة أطلب الأحمر بس خلص من المقاس بتاعي. شكراً على الخدمة الحلوة والجودة العالية."</p>
                    <div class="testimonial-author">نورا سمير</div>
                    <div class="testimonial-city">الإسماعيلية</div>
                </div>
            </div>
        </div>

        <div class="featured-testimonial" style="margin-top: 50px;">
            <div class="testimonial-card" style="position: relative;">
                <div class="ribbon"><span>أفضل تقييم</span></div>
                <div class="testimonial-image-wrapper">
                    <div class="testimonial-image-container testimonial-image-container-featured">
                        <img src="images/reviews/rila-biyeli-elbise-beyaz-2a8c2c.jpeg" alt="تقييم مميز" loading="lazy">
                    </div>
                </div>
                <div class="testimonial-content">
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="testimonial-text">"اشتريت فستان لوتس كهدية لأختي وكانت سعيدة جداً به! القماش راقي والتصميم أنيق ويناسب مختلف المناسبات. الألوان جميلة جداً والمقاسات مضبوطة. كل مرة ترتديه تتلقى إعجاب من الجميع. سنطلب المزيد منه بالتأكيد. أفضل استثمار لخزانة الملابس!"</p>
                    <div class="testimonial-author">شيماء الشرقاوي</div>
                    <div class="testimonial-city">القاهرة</div>
                </div>
            </div>
        </div>
        
        <div class="testimonials-cta">
            <p>انضمي لآلاف العميلات السعيدات واطلبي فستان لوتس الآن</p>
            <a href="#order-form-placeholder" class="btn testimonial-btn">اطلبي الآن</a>
        </div>
    </div>
</section>

<!-- Estilos optimizados para sección de testimonios -->
<style>
    .testimonials {
        padding: 80px 0;
        background-color: var(--light-color);
        position: relative;
        overflow: hidden;
    }
    
    .testimonials:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url('images/pattern-light.svg');
        background-size: 200px;
        opacity: 0.05;
        pointer-events: none;
    }
    
    .section-subtitle {
        text-align: center;
        margin-bottom: 40px;
        color: #666;
        font-size: 1.1rem;
    }
    
    .testimonials-slider {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 30px;
        margin-bottom: 20px;
    }
    
    .testimonial-card {
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
        height: 100%;
        position: relative;
        backface-visibility: hidden;
        will-change: transform;
        padding-bottom: 20px;
    }
    
    .testimonial-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
    }
    
    .testimonial-badge-container {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 3;
    }
    
    .testimonial-badge {
        display: inline-block;
        background: linear-gradient(135deg, var(--accent-color), #800f1a);
        color: white;
        font-size: 0.7rem;
        padding: 3px 10px;
        border-radius: 20px;
        font-weight: 700;
        box-shadow: 0 3px 10px rgba(191, 30, 46, 0.2);
    }
    
    .testimonial-image-wrapper {
        width: 100%;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
        overflow: hidden;
        max-height: 400px;
        margin-bottom: 20px;
    }
    
    .testimonial-image-container {
        width: 100%;
        height: 350px;
        position: relative;
        overflow: hidden;
        margin-bottom: 20px;
        background-color: #f9f9f9;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .testimonial-image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center top;
        transition: transform 0.5s ease;
        transform: scale(1.01);
        backface-visibility: hidden;
        will-change: transform;
        background-color: #f9f9f9;
        opacity: 0.95;
    }
    
    .testimonial-image-container-featured {
        height: 400px;
    }
    
    .testimonial-card:hover .testimonial-image-container img {
        transform: scale(1.05);
    }
    
    /* Add loading animation for images */
    .testimonial-image-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        animation: loading 1.5s infinite;
        z-index: 1;
    }
    
    .testimonial-image-container img[src*="default-avatar.jpg"]::after {
        content: "صورة غير متوفرة";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #999;
        font-size: 0.9rem;
        text-align: center;
    }
    
    @keyframes loading {
        0% {
            transform: translateX(-100%);
        }
        100% {
            transform: translateX(100%);
        }
    }
    
    /* Fix for image loading */
    .testimonial-image-container img.loaded::before {
        display: none;
    }
    
    .testimonial-content {
        padding: 0 20px 20px;
    }
    
    .rating {
        color: #FFD700;
        font-size: 1.1rem;
        margin-bottom: 15px;
        display: flex;
        justify-content: center;
        gap: 3px;
    }
    
    .testimonial-text {
        font-size: 0.95rem;
        line-height: 1.7;
        color: #555;
        margin-bottom: 15px;
        font-style: italic;
        min-height: 100px;
        position: relative;
        z-index: 1;
    }
    
    .testimonial-text::before {
        content: '"';
        font-size: 4rem;
        color: rgba(191, 30, 46, 0.06);
        position: absolute;
        top: -20px;
        right: 10px;
        z-index: -1;
        font-family: serif;
    }
    
    .testimonial-author {
        font-weight: 700;
        color: var(--secondary-color);
        font-size: 1.1rem;
        position: relative;
        display: inline-block;
    }
    
    .testimonial-author::after {
        content: '';
        position: absolute;
        bottom: -5px;
        right: 25%;
        width: 50%;
        height: 2px;
        background: linear-gradient(90deg, transparent, rgba(191, 30, 46, 0.3), transparent);
    }
    
    .testimonial-city {
        color: #888;
        font-size: 0.85rem;
        margin: 10px 0;
    }
    
    .ribbon {
        width: 150px;
        height: 150px;
        overflow: hidden;
        position: absolute;
        top: 0;
        right: 0;
        z-index: 2;
    }
    
    .ribbon span {
        position: absolute;
        display: block;
        width: 225px;
        padding: 8px 0;
        background-color: var(--accent-color);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        color: #fff;
        font-size: 0.8rem;
        text-align: center;
        font-weight: 700;
        top: 30px;
        right: -25px;
        transform: rotate(45deg);
    }
    
    .featured-testimonial {
        max-width: 650px;
        margin: 50px auto 0;
        padding: 0 15px;
    }
    
    .featured-testimonial .testimonial-card {
        border: 2px solid var(--accent-color);
        transform: scale(1.02);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }
    
    .featured-testimonial .testimonial-text {
        font-size: 1.05rem;
        min-height: auto;
    }
    
    .testimonials-cta {
        text-align: center;
        background: linear-gradient(135deg, var(--accent-color), #800f1a);
        padding: 30px;
        border-radius: 12px;
        margin-top: 50px;
        color: white;
        position: relative;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(191, 30, 46, 0.2);
    }
    
    .testimonials-cta::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url('images/pattern-light.svg');
        background-size: 100px;
        opacity: 0.1;
        pointer-events: none;
    }
    
    .testimonials-cta p {
        font-size: 1.3rem;
        margin-bottom: 20px;
        font-weight: 600;
        position: relative;
    }
    
    .testimonial-btn {
        background: white;
        color: var(--accent-color);
        border: none;
        padding: 12px 30px;
        font-size: 1.1rem;
        font-weight: 700;
        border-radius: 30px;
        transition: all 0.3s ease;
        display: inline-block;
        text-decoration: none;
        position: relative;
        overflow: hidden;
        z-index: 1;
    }
    
    .testimonial-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: all 0.6s ease;
    }
    
    .testimonial-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    
    .testimonial-btn:hover::before {
        left: 100%;
    }
    
    /* Optimizaciones para móvil */
    @media (max-width: 768px) {
        .testimonials-slider {
            grid-template-columns: 1fr;
            gap: 30px;
        }
        
        .testimonial-text {
            min-height: auto;
            font-size: 0.9rem;
        }
        
        .testimonials {
            padding: 50px 0;
        }
        
        .section-title {
            font-size: 1.8rem;
        }
        
        .section-subtitle {
            font-size: 1rem;
        }
        
        .testimonials-cta p {
            font-size: 1.1rem;
        }
        
        .testimonial-image-container {
            height: 280px;
        }
        
        .testimonial-image-container-featured {
            height: 320px;
        }
        
        .ribbon span {
            width: 200px;
            font-size: 0.75rem;
            padding: 5px 0;
            top: 25px;
            left: -35px;
        }
    }
    
    /* Animaciones para optimizar rendimiento en dispositivos móviles */
    @media (prefers-reduced-motion: reduce) {
        .testimonial-card,
        .testimonial-card:hover,
        .testimonial-image-container,
        .testimonial-image-container img,
        .testimonial-btn {
            transition: none;
            transform: none;
        }
    }
    
    @media (max-width: 480px) {
        .testimonial-card {
            margin-left: 5px;
            margin-right: 5px;
        }
        
        .testimonial-text {
            padding: 0 5px;
        }
        
        .testimonials-cta {
            margin: 30px 5px 0;
            padding: 20px 15px;
        }
        
        .testimonial-image-container {
            height: 240px;
        }
        
        .testimonial-image-container-featured {
            height: 280px;
        }
    }
    
    .testimonial-image-container.loaded::before {
        display: none;
    }
    
    .testimonial-image-container img.default-avatar {
        object-fit: contain;
        padding: 20px;
        opacity: 0.7;
    }
    
    /* Add subtle fade-in animation for testimonials */
    .fade-in-up {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    }
    
    .fade-in-up.animated {
        opacity: 1;
        transform: translateY(0);
    }
    
    /* Add delay classes for staggered animation */
    .delay-1 {
        transition-delay: 0.2s;
    }
    
    .delay-2 {
        transition-delay: 0.4s;
    }
    
    /* Custom scrollbar for better UX */
    .testimonial-text::-webkit-scrollbar {
        width: 4px;
    }
    
    .testimonial-text::-webkit-scrollbar-track {
        background: #f1f1f1;
    }
    
    .testimonial-text::-webkit-scrollbar-thumb {
        background: #ccc;
        border-radius: 10px;
    }
    
    .testimonial-text::-webkit-scrollbar-thumb:hover {
        background: #999;
    }
</style>

<!-- Script para animación de testimonios -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Verificar imágenes y usar imagen por defecto si fallan
        const testimonialImages = document.querySelectorAll('.testimonial-image-container img');
        
        // Create a default avatar in memory if not found
        const createDefaultAvatar = () => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas dimensions
            canvas.width = 200;
            canvas.height = 200;
            
            // Create gradient background
            const gradient = ctx.createLinearGradient(0, 0, 200, 200);
            gradient.addColorStop(0, '#f8f8f8');
            gradient.addColorStop(1, '#e6e6e6');
            
            // Fill background
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 200, 200);
            
            // Add text
            ctx.fillStyle = '#999';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('صورة غير متوفرة', 100, 100);
            
            // Add circle outline
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 5;
            ctx.beginPath();
            ctx.arc(100, 80, 50, 0, Math.PI * 2);
            ctx.stroke();
            
            // Return data URL
            return canvas.toDataURL('image/jpeg');
        };
        
        // Default avatar data URL
        const defaultAvatarUrl = createDefaultAvatar();
        
        // Add custom HTML content to document head for better performance
        document.head.insertAdjacentHTML('beforeend', `
            <link rel="preload" href="images/reviews/PHOTO-2025-04-20-14-59-10.jpg" as="image">
            <link rel="preload" href="images/reviews/black-review.jpeg" as="image">
            <link rel="preload" href="images/reviews/review-3.png" as="image">
            
            <style>
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                
                .animated {
                    opacity: 1 !important;
                    transform: translateY(0) !important;
                }
                
                .image-loaded {
                    opacity: 1;
                    transform: scale(1);
                }
                
                .testimonial-image-container img {
                    cursor: pointer;
                }
                
                .image-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0, 0, 0, 0.8);
                    z-index: 9999;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                    cursor: pointer;
                }
                
                .image-overlay.active {
                    opacity: 1;
                }
                
                .image-overlay.closing {
                    opacity: 0;
                }
                
                .full-image {
                    max-width: 90%;
                    max-height: 90%;
                    object-fit: contain;
                    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
                    transform: scale(0.9);
                    transition: transform 0.3s ease;
                    background-color: #fff;
                    border-radius: 5px;
                }
                
                .image-overlay.active .full-image {
                    transform: scale(1);
                }
            </style>
        `);
        
        // Lazy load additional images that are further down the page
        const lazyLoadImages = [
            "images/reviews/navy-blue-review.jpeg",
            "images/reviews/PHOTO-2025-04-20-14-59-09.jpg",
            "images/reviews/PHOTO-2025-04-20-14-59-11.jpg",
            "images/reviews/rila-biyeli-elbise-beyaz-2a8c2c.jpeg"
        ];
        
        testimonialImages.forEach(img => {
            // Mark when image is successfully loaded
            img.addEventListener('load', function() {
                this.classList.add('loaded');
                // Remove loading animation
                const container = this.closest('.testimonial-image-container');
                if (container) {
                    container.classList.add('loaded');
                }
            });
            
            // Use default avatar if image fails to load
            img.addEventListener('error', function() {
                this.src = defaultAvatarUrl;
                this.classList.add('default-avatar');
            });
            
            // Preload images to avoid flickering
            if (img.complete) {
                img.classList.add('loaded');
            } else {
                // Start loading
                const newImg = new Image();
                newImg.src = img.src;
                newImg.onload = () => {
                    img.classList.add('loaded');
                };
                newImg.onerror = () => {
                    img.src = defaultAvatarUrl;
                    img.classList.add('default-avatar');
                };
            }
            
            // Add click functionality to view larger image
            img.addEventListener('click', function() {
                const overlay = document.createElement('div');
                overlay.className = 'image-overlay';
                
                const fullImage = document.createElement('img');
                fullImage.src = this.src;
                fullImage.className = 'full-image';
                fullImage.alt = this.alt || 'صورة تقييم';
                
                overlay.appendChild(fullImage);
                
                overlay.addEventListener('click', function() {
                    this.classList.add('closing');
                    setTimeout(() => {
                        this.remove();
                    }, 300);
                });
                
                document.body.appendChild(overlay);
                setTimeout(() => {
                    overlay.classList.add('active');
                }, 10);
            });
        });
        
        // Preload remaining images after main content is loaded
        window.addEventListener('load', function() {
            setTimeout(() => {
                lazyLoadImages.forEach(imageSrc => {
                    const img = new Image();
                    img.src = imageSrc;
                });
            }, 1000);
        });
        
        // Añadir animaciones de entrada
        const testimonialCards = document.querySelectorAll('.testimonial-card');
        
        // Detectar si es dispositivo móvil
        const isMobile = window.innerWidth <= 768;
        
        // Reducir animaciones en dispositivos móviles para mejorar rendimiento
        const reducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        
        if (!reducedMotion) {
            // Usar Intersection Observer para animar entrada
            if ('IntersectionObserver' in window) {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            // Añadir clase para animar con un retraso progresivo
                            const index = Array.from(testimonialCards).indexOf(entry.target);
                            setTimeout(() => {
                                entry.target.classList.add('animated');
                            }, isMobile ? 100 * index : 150 * index);
                            observer.unobserve(entry.target);
                        }
                    });
                }, { 
                    threshold: isMobile ? 0.1 : 0.2,
                    rootMargin: '0px 0px 50px 0px'
                });
                
                // Observar todas las tarjetas
                testimonialCards.forEach(card => {
                    observer.observe(card);
                });
            } else {
                // Fallback para navegadores sin soporte para Intersection Observer
                testimonialCards.forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('animated');
                    }, 300 + (isMobile ? 100 * index : 150 * index));
                });
            }
        } else {
            // Si el usuario prefiere reducir animaciones, mostrar directamente
            testimonialCards.forEach(card => {
                card.classList.add('animated');
            });
        }
        
        // Ajustar altura de las tarjetas para mantener consistencia
        if (!isMobile) {
            window.addEventListener('load', function() {
                setTimeout(() => {
                    // Agrupar tarjetas por filas
                    const firstRow = document.querySelectorAll('.testimonials-slider:first-child .testimonial-card');
                    const secondRow = document.querySelectorAll('.testimonials-slider:nth-child(2) .testimonial-card');
                    
                    // Ajustar altura en cada fila independientemente
                    adjustHeight(firstRow);
                    adjustHeight(secondRow);
                    
                    function adjustHeight(cards) {
                        if (cards.length === 0) return;
                        
                        const maxHeight = Math.max(...Array.from(cards).map(card => 
                            card.querySelector('.testimonial-text').offsetHeight
                        ));
                        
                        cards.forEach(card => {
                            const text = card.querySelector('.testimonial-text');
                            if (text.offsetHeight < maxHeight) {
                                text.style.minHeight = `${maxHeight}px`;
                            }
                        });
                    }
                }, 500);
            });
        }
    });
</script> 